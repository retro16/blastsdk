Build Order List (bol)
======================

The build order list (shortened as bol) is the list of sources that need to be compiled in a blsgen project, in the order that minimizes unsatisfied dependencies (unsatisfied dependencies may change the size of the final binary at link time).

To track dependencies, blsgen stores 3 kinds of objects : sources, sections and binaries.

A source is a source file ( *.c, *.png, *.asm, ... ) and it provides sections once compiled.

For code sources, sections simply match the ones generated by the compiler ( .text, .data and .bss ). For other types, they may vary. For example, PNG files can generate .img (pixel data), .pal (palette) and .map (tile map). A section is simply a raw binary data file in the form directly used by the target CPU.

Binaries are groups of sections that may be loaded or unloaded at any time by the programmer. This group of sections can be optionally compressed before being written to the image file.


How Build Order List is generated
=================================

The aim is to create the list of sources needed to compile all used binaries.


Binary load graph
-----------------

Binaries track which binaries they load, forming a graph. Only binary loading are taken into account. At the end of compilation, all used sections must be loaded by at least one binary : if this requirement is not met, this is a compilation error since unreachable data is accessed.


Provided sections
-----------------

For each used binary, the list of provided sections is tracked. The provided sections are sections effectively contained in the binary. It may contain unused sections, generating a suboptimal output image with data in excess.

For some platforms (especially CD), it may be interesting to put a section in more than one binary to improve loading times by decreasing seeks. When generating the BOL, only the first occurence of each section is taken into account.


Section source
--------------

Each section tracks its source, but the source may generate more than one section. Each source may be added only once to the bol.


Final algorithm
---------------

```
Initialize the list of used binaries
Initialize the build order list
Call procedure gen_bol with the entry point binary

Procedure gen_bol:

If the binary is already in the list of used binaries then exit procedure

Add binary to the list of used binaries

For each provided section:
  Add the section to the list of used sections
  Find the source of this section
  Add the source of this section to the bol
End for

For each binary loaded by the current binary:
  Call procedure gen_bol with the loaded binary
End for
```
